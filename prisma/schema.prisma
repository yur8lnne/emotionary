generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
}

model Diary {
  id        Int      @id @default(autoincrement())
  userId    Int
  content   String
  date      DateTime
  createdAt DateTime @default(now())

  user      User     @relation(fields: [userId], references: [id], map: "Diary_userId_fkey")

  emotions  Emotion[]  // Diary에 연결된 감정들

  @@index([userId], map: "Diary_userId_fkey")
}

model Friend {
  id                         String @id @default(cuid())
  ownerId                    Int
  friendId                   Int
  order                      Int

  owner  User @relation("UserFriends", fields: [ownerId], references: [id])
  friend User @relation("UserFriendOf", fields: [friendId], references: [id])

  @@unique([ownerId, friendId])
  @@index([friendId])
}

model User {
  id                           Int       @id @default(autoincrement())
  userId                       String    @unique(map: "User_userId_key")
  password                     String
  name                         String?
  email                        String?   @unique(map: "User_email_key")
  phone                        String?   @unique(map: "User_phone_key")
  createdAt                    DateTime  @default(now())

  diary                        Diary[]
  friends   Friend[] @relation("UserFriends")
  friendOf  Friend[] @relation("UserFriendOf")
  emotions                      Emotion[] // user가 선택한 이모티콘
}

model Emotion {
  id       Int      @id @default(autoincrement())
  icon     String
  date     DateTime

  userId   Int
  user     User     @relation(fields: [userId], references: [id])

  diaryId  Int?     // optional: Diary와 연결
  diary    Diary?   @relation(fields: [diaryId], references: [id])
}
